---
Author: Maxim Orlovsky
Proposed: 20 Jul 2025
License: CC-BY
---

# RGB wallet descriptors general operations

This standard defines wallet script descriptors for RGB-compatible bitcoin wallets
based on [BIP-380] specification.

## Background

Output Script Descriptors is a declarative language made of [combinators], defined in
[BIP-380: Output Script Descriptors General Operation][BIP-380] and used throughout the
Bitcoin ecosystem, from Bitcoin Core and other node implementations to wallets.

## Specification

This specification is based on and compatible with [BIP-380].
It also uses conventions (like expression types, allowed characters etc) from it.

New `SCRIPT` expressions are defined:
- `rgb()`: a top-level-only expression;
- `seals()` an expression which must be present only as the second `rgb` argument.

New expressions are defined: `SEAL` and `NOISE`.

RGB-compatible descriptors MUST NOT use checksum (see [rational](#no-checksum)).

### `rgb()`

The `rgb()` script expression has a form `rgb(SCRIPT,seals(),NOISE)`. 
It conforms to `SCRIPT` type, defined in [BIP-380], and always takes exactly three arguments:
- the first argument: top-level output `SCRIPT` expression of an underlying 
  RGB-enabled Bitcoin wallet;
- the second argument: `seals()` `SCRIPT` expression (see below);
- the third argument: `NOISE` expression (see below).

### `seals()`

The `seals()` expression MUST contain a list of seal definitions created by the wallet and used
in not-yet-fulfilled (unpaid) invoices.

The expression takes a list of monomorphic arguments of `SEAL` expression type (see below),
separated by comma(s).

With each new issued invoice a new seal definition is added
(as an arguments for `seals()` expression), and when the payment finalizes, it gets removed.

### `SEAL` expression

The `SEAL` expression represents a single RGB seal definition
(see the specification on seal definitions in [RGB-1] standard).

Briefly, it has the form of `OUTPOINT/FAILBACK`, where `OUTPOINT` represents the primary
seal -- a Bitcoin transaction outpoint, consisting of transaction id and output number
(`OUTPOINT:VOUT`).

The `FAILBACK` fragment represents a failback seal, which may have two forms:
- a failback seal definition, which is another Bitcoin transaction outpoint,
  consisting of transaction id and output number (`OUTPOINT:VOUT`);
- a seal noise adding randomness and privacy to the seal definition in case if a failback seal
  is not defined.

In the second case the seal noise is generated by the wallet using `NOISE` seed data (see below),
and is a Base58 and little-endian-encoded 256-bit integer (with no prefix or checksum).

### `NOISE` expression

The `NOISE` expression is 256-bit unsigned integer value
encoded as a little-endian hexadecimal literal.
It represents a noise seed used in generating seal noise data when no failback seal is
defined (see [RGB-1] specification).

## Reference implementation

RGB descriptors are implemented in [`rgb-descriptors`] rust crate.
Its source code is available on [GitHub].

## Rationale

### No checksum

Unlike other output descriptors based on [BIP-380],
RGB descriptors change over the time a wallet is used:
with each new issued invoice a new seal definition is added
(as an arguments for `seals()` expression), and when the payment finalizes, it gets removed.

Thus, a checksum defined according to [BIP-380] will be changing over the time

### Hexadecimal encoding for `NOISE`

Noise data are encoded as a hexadecimal string since:
- unlike extended keys they always appear only once, and
- the difference in length between hexadecimal-encoded 256-bit string
  and any other encoding doesn't increase the size of a typical descriptor for more than
  10-15%.

At the same time it allows easier visual differentiation from extended keys and speeds up parsing.

### Hexadecimal encodings of seal definitions in `SEAL`

Seals consists of one or two (in case if a failback seal is defined) bitcoin transaction outputs.
In order or allow visual recognition and copying of transaction outputs (for instance for checingg
with a Bitcoin explorer) they use the hexadecimal encoding standard for Bitcoin transaction outputs.

### Base58 encoding of seal-specific noise data in `SEAL`

Seal-specific noise data, used in case if no failback seal is defined
(NB: not the same as `NOISE` data of the `rgb()` expression)
are encoded with Base58 in order to be clearly differentiated from the failback seals
encoded in a hexadecimal format (see above).

Base58 is selected since it is used in encoding extended keys, and output descriptors
parsers already have it as a dependency.

However, unlike extended keys, no prefix (like `xpub`/`xprv`) is added, since the number
of seal definitions may grow orders of magnitude larger than the numer of used keys,
and adding additional four characters may significantly increase the descriptor size.
The noise part of seal definitions is anyway clearly visually differentiated from the rest
of descriptor (via use of dedicated `seal()` expression and a bitcoin transaction output
prefix), and thus any user confusion is improbable.

## Test vectors

### Correct descriptors

- Wpkh-based opret descriptor with no seals defined:

        rgb(
            wpkh([643a7adc/86h/1h/0h]tpubDCNiWHaiSkgnQjuhsg9kjwaUzaxQjUcmhagvYzqQ3TYJTgFGJstVaqnu4yhtFktBhCVFmBNLQ5sN53qKzZbMksm3XEyGJsEhQPfVZdWmTE2/<0;1>/*),
            seals(),
            ab0ad54f432146f9a8108dbf0f7d38bd3e3657bf4c873a9907befd579319f038
        )

- Wpkh-based opret descriptor with a single seal defined (no failback):

        rgb(
            wpkh([643a7adc/86h/1h/0h]tpubDCNiWHaiSkgnQjuhsg9kjwaUzaxQjUcmhagvYzqQ3TYJTgFGJstVaqnu4yhtFktBhCVFmBNLQ5sN53qKzZbMksm3XEyGJsEhQPfVZdWmTE2/<0;1>/*),
            seals(567a6748b96097f72ed20d8c46f4981062d8a34e9641122d2a76106f808abdc8:129/F8GCQc9BuWAA7kGouPwxjZMA9WBNgFGFHG9kqYDNPFrN),
            ab0ad54f432146f9a8108dbf0f7d38bd3e3657bf4c873a9907befd579319f038
        )

- Wpkh-based opret descriptor with multiple seals defined (no failback):

        rgb(
            wpkh([643a7adc/86h/1h/0h]tpubDCNiWHaiSkgnQjuhsg9kjwaUzaxQjUcmhagvYzqQ3TYJTgFGJstVaqnu4yhtFktBhCVFmBNLQ5sN53qKzZbMksm3XEyGJsEhQPfVZdWmTE2/<0;1>/*),
            seals(
                e97798360bd4821e52d5b50d4fa8385ee5a544d5e5c741ca4ff440d044effdad:129/397G2XyBYQZZX6YxnTHyJocEPszPQZTmnwBRQcpGuMCu,
                567a6748b96097f72ed20d8c46f4981062d8a34e9641122d2a76106f808abdc8:129/F8GCQc9BuWAA7kGouPwxjZMA9WBNgFGFHG9kqYDNPFrN
            ),
            ab0ad54f432146f9a8108dbf0f7d38bd3e3657bf4c873a9907befd579319f038
        )

- Wpkh-based opret descriptor with a failback seal definition:

        rgb(
            wpkh([643a7adc/86h/1h/0h]tpubDCNiWHaiSkgnQjuhsg9kjwaUzaxQjUcmhagvYzqQ3TYJTgFGJstVaqnu4yhtFktBhCVFmBNLQ5sN53qKzZbMksm3XEyGJsEhQPfVZdWmTE2/<0;1>/*),
            seals(567a6748b96097f72ed20d8c46f4981062d8a34e9641122d2a76106f808abdc8:129/9af9ed818593bffb85b4bc5b11fe835fe3cb96c1e2b8aacb0904f3a2fa3d59c2:2),
            ab0ad54f432146f9a8108dbf0f7d38bd3e3657bf4c873a9907befd579319f038
        )

### Invalid descriptors

- Wpkh-based opret descriptor with no seals defined containing 248-bit noise (1 byte lost):

        rgb(
            wpkh([643a7adc/86h/1h/0h]tpubDCNiWHaiSkgnQjuhsg9kjwaUzaxQjUcmhagvYzqQ3TYJTgFGJstVaqnu4yhtFktBhCVFmBNLQ5sN53qKzZbMksm3XEyGJsEhQPfVZdWmTE2/<0;1>/*),
            seals(),
            ab0ad54f432146f9a8108dbf0f7d38d3e3657bf4c873a9907befd579319f038
        )

- Wpkh-based opret descriptor with an invalid seal definition:

        rgb(
            wpkh([643a7adc/86h/1h/0h]tpubDCNiWHaiSkgnQjuhsg9kjwaUzaxQjUcmhagvYzqQ3TYJTgFGJstVaqnu4yhtFktBhCVFmBNLQ5sN53qKzZbMksm3XEyGJsEhQPfVZdWmTE2/<0;1>/*),
            seals(567a6748b96097f72ed20d8c46f4981062d8a34e9641122d2a76106f808abdc8/F8GCQc9BuWAA7kGouPwxjZMA9WBNgFGFHG9kqYDNPFrN),
            ab0ad54f432146f9a8108dbf0f7d38bd3e3657bf4c873a9907befd579319f038
        )

- Wpkh-based opret descriptor with an invalid seal noise data:

        rgb(
            wpkh([643a7adc/86h/1h/0h]tpubDCNiWHaiSkgnQjuhsg9kjwaUzaxQjUcmhagvYzqQ3TYJTgFGJstVaqnu4yhtFktBhCVFmBNLQ5sN53qKzZbMksm3XEyGJsEhQPfVZdWmTE2/<0;1>/*),
            seals(
                e97798360bd4821e52d5b50d4fa8385ee5a544d5e5c741ca4ff440d044effdad:129/397G2XyBYQZZX6YxnTHyJocEPszTmnwBRQcpGuMCu,
                567a6748b96097f72ed20d8c46f4981062d8a34e9641122d2a76106f808abdc8:129/F8GCQc9BuWAA7kGouPwxjZMA9WBNgFGFHG9kqYDNPFrN
            ),
            ab0ad54f432146f9a8108dbf0f7d38bd3e3657bf4c873a9907befd579319f038
        )

- Wpkh-based opret descriptor with an invalid failback seal definition:

        rgb(
            wpkh([643a7adc/86h/1h/0h]tpubDCNiWHaiSkgnQjuhsg9kjwaUzaxQjUcmhagvYzqQ3TYJTgFGJstVaqnu4yhtFktBhCVFmBNLQ5sN53qKzZbMksm3XEyGJsEhQPfVZdWmTE2/<0;1>/*),
            seals(567a6748b96097f72ed20d8c46f4981062d8a34e9641122d2a76106f808abdc8:129/9af9ed818593bffb85b4bc5b11fe835fe3cb96c1e2b8aacb0904f3a2fa3dc2:2),
            ab0ad54f432146f9a8108dbf0f7d38bd3e3657bf4c873a9907befd579319f038
        )

[combinators]: https://writings.stephenwolfram.com/2020/12/combinators-a-centennial-view/

[BIP-380]: https://github.com/bitcoin/bips/blob/master/bip-0380.mediawiki

[`rgb-descriptors`]: https://crates.io/crates/rgb-descriptors

[GitHub]: https://github.com/RGB-WG/rgb/tree/master/descriptors/src

[RGB-1]: https://github.com/RGB-WG/RFC/blob/master/RGB-0001.md
